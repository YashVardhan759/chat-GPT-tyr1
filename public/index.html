
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script type="module"  src="firebase.js"></script>
<!-- <script src=" https://requirejs.org/docs/release/2.3.5/minified/require.js"></script> -->
<script src = "https://cdn.jsdelivr.net/npm/showdown@<version>/dist/showdown.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


<title>ChatGPT Web Page</title>
<style>

    body {
        margin: 0;
        padding: 0;
        height: 100%;
        display: flex;
        flex-direction: column;
        color: white;
    }
    .content {
        background-color: #333;
        display: flex;
        flex-direction: column;
        height: calc(100vh - 90px);
        font-size: 20px;
    }
    .header {
        background-color: #333;
        color: #fff;
        padding: 10px;
        text-align: center;
        font-size: 24px;
        flex-grow: 1;
    }
    .chat-area {
        flex-grow: 1;
        height: 100%;
        overflow-y: auto;
        padding: 10px 15%;
        padding-top: 50px;
        flex-grow: 1;
        /* border: 1px solid red; */
    }
    .input-area {
        flex-grow: 1;
        margin: 15px 20%;
        margin-bottom: 20px;
        padding: 10px 20px;
        flex-grow: 1;
        display: flex;
        flex-direction: row;
    }
    .input-area input[type="text"] {
        padding: 12px;
        border: none;
        border-radius: 5px;
        outline: none;
        font-size: medium;
        flex-grow: 1;
    }
    .input-area input[type="button"] {
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 8px 25px;
        cursor: pointer;
        margin-left: 10px;
    }
    .footer {
        background-color: #333;
        color: #fff;
        text-align: center;
        position: fixed;
        bottom: 0;
        padding-bottom: 15px;
        width: 100%;
    }

</style>
</head>
<body>

    <div class="content">
        <div class="header"></div>
        <div class="chat-area" id="chatArea"></div>
    </div>



<footer class="footer">
    <div class="input-area">
        <input type="text" id="userInput" placeholder="Type your message...">
        <input type="button" value="Send" onclick="get_gemini_response()">
        <input type="button" value="Send" onclick= "save_in_firebase('wefw')">
    </div> 
</footer>



<script>

    function displayMessage(sender, message) {
        var chatArea = document.getElementById('chatArea');
        var messageDiv = document.createElement('div');
        messageDiv.classList.add('message');
        if (sender === 'user') {
            messageDiv.classList.add('user-message');
        } else if (sender === 'bot') {
            messageDiv.classList.add('bot-message');
        }
        messageDiv.innerHTML = message;
        chatArea.appendChild(messageDiv);
        chatArea.scrollTop = chatArea.scrollHeight;
    }

    async function get_gemini_response()
    {
        var userInput = document.getElementById('userInput').value;
        displayMessage('user', userInput);
        const response = await fetch( "/.netlify/functions/gemini2"
        ,{
            method:'POST',
            body:JSON.stringify({
            question:userInput.trim()
            })
        }
        ).then(response => response.json())

        console.log("got the response")
        console.log(response)
        setOutput(response)
    }

    function setOutput(response){

        displayMessage("bot",marked.parse(response));
        displayMessage("bot",marked.parse("<p>\n\n</p>"));
        document.getElementById('userInput').value = '';

    }

    async function save_in_firebase()
    {
        var userInput = document.getElementById('userInput').value;
        const response = await fetch( "/.netlify/functions/save_firebase"
        ,{
            method:'POST',
            body:JSON.stringify({
                data:userInput.trim()
            })
        }
        ).then(console.log("done"))

        // console.log("got the response")
        // console.log(response)
        // setOutput(response)
    }


</script>

</body>

</html>



























<!-- <!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jamstack Explorers - Up and Running with Serverless Functions</title>
  </head>

  <body>

    <div class="container">
      <h1>ChatGPT Web App</h1>
      <div>
          <textarea id="user-input" rows="4" placeholder="Type your message here..."></textarea>
          <button onclick="get_gemini_response()">Send</button>
      </div>
      <div id="chat-box"></div>
    </div>






    <script>


    async function sendMessage()
    {
        const userInput = document.getElementById('user-input').value.trim();
        const GOOGLE_API_KEY = 'AIzaSyDMDjSzsuRKGk3q0XrtiSpr03ZlJGou1Yo'; // Replace with your actual API key

        const postData = {
            contents: [
                {
                    parts: [
                        { text: userInput }
                    ]
                }
            ]
        };

        fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=' + GOOGLE_API_KEY, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(postData)
        })
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
          const text = data.candidates[0].content.parts[0].text
          appendMessage(text)
        })
        .catch(error => {
            console.error('There was a problem with your fetch operation:', error);
        });





    }

    async function get_gemini_response()
    {
      const response = await fetch( "/.netlify/functions/gemini2"
      ,{
        method:'POST',
        body:JSON.stringify({
          question:document.getElementById('user-input').value.trim()
        })
      } 
    ).then(response => response.json())

    console.log(typeof response)
    appendMessage(response)

    }

function appendMessage(message) {
    const chatBox = document.getElementById('chat-box');
    const messageElement = document.createElement('div');
    messageElement.textContent = message;
    chatBox.appendChild(messageElement);
    chatBox.scrollTop = chatBox.scrollHeight; // scroll to bottom
}


    </script>
  </body>


</html> -->



